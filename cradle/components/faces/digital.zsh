#!/usr/bin/env zsh

# ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
# ┃ ┌────────────────────────────────────────────────────────────────────────────────────────────┐ ┃
# ┃ ├────────────────────────────────────────────────────────────────────────────────────────────┤ ┃
# ┃ ├──────────┐                     dP                dP                   dP        ┌──────────┤ ┃
# ┃ ├──────────┤                     88                88                   88        ├──────────┤ ┃
# ┃ ├──────────┤   d888888b .d8888b. 88d888b. .d8888b. 88 .d8888b. .d8888b. 88  .dP   ├──────────┤ ┃
# ┃ ├──────────┤      .d8P' Y8ooooo. 88'  `88 88'  `"" 88 88'  `88 88'  `"" 88888"    ├──────────┤ ┃
# ┃ ├──────────┤    .Y8P          88 88    88 88.  ... 88 88.  .88 88.  ... 88 `8b.   ├──────────┤ ┃
# ┃ ├──────────┤   d888888P `88888P' dP    dP `88888P' dP `88888P' `88888P' dP  `YP   ├──────────┤ ┃
# ┃ ├──────────┘                                                                      └──────────┤ ┃
# ┃ ├────────────────────────────────────────────────────────────────────────────────────────────┤ ┃
# ┃ ├────────────────────────────────────────────────────────────────────────────────────────────┤ ┃
# ┃ ├────────────────────┐                                                 ┌─────────────────────┤ ┃
# ┃ ├────────────────────┤   copyright (c) 2025 Malakai Smith (@tenault)   ├─────────────────────┤ ┃
# ┃ ├────────────────────┤   originally forked from @octobanana/peaclock   ├─────────────────────┤ ┃
# ┃ ├────────────────────┘                                                 └─────────────────────┤ ┃
# ┃ ├────────────────────────────────────────────────────────────────────────────────────────────┤ ┃
# ┃ ├────────────────────────────────────────────────────────────────────────────────────────────┤ ┃
# ┃ ├────────┐                                                                         ┌─────────┤ ┃
# ┃ ├────────┤   This Source Code Form is subject to the terms of the Mozilla Public   ├─────────┤ ┃
# ┃ ├────────┤   License, v. 2.0. If a copy of the MPL was not distributed with this   ├─────────┤ ┃
# ┃ ├────────┤   file, you can obtain one at https://mozilla.org/MPL/2.0               ├─────────┤ ┃
# ┃ ├────────┘                                                                         └─────────┤ ┃
# ┃ ├────────────────────────────────────────────────────────────────────────────────────────────┤ ┃
# ┃ └────────────────────────────────────────────────────────────────────────────────────────────┘ ┃
# ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛

# ┌────────────────────────────────┐┌─────────────┐┌╴╴╴╴╴╴╴╴╴╴╴╴╴╴╴┐
# │ ░░▒▒▓▓██  COMPONENTS  ██▓▓▒▒░░ ││    FACES    │╎    DIGITAL    ╎
# └────────────────────────────────┘└─────────────┘└╶╶╶╶╶╶╶╶╶╶╶╶╶╶╶┘

# ┌─────────────┐
# │    order    │
# └─────────────┘

function ztc:component:order:face:digital {
    ztc[face:digital:y]=:auto
    ztc[face:digital:x]=:auto
    ztc[face:digital:h]=:auto
    ztc[face:digital:w]=:auto

    ztc[face:digital:data:format]=masked
}


# ┌─────────────┐
# │    alter    │
# └─────────────┘

function ztc:component:alter:face:digital {

    # ───── get time + setup ─────

    local _ztcafd_time=''
    strftime -s _ztcafd_time "%l:%M:%S"

    local _ztcafd_mask=()
    local _ztcafd_staged=()


    # ───── create mask ─────

    for _ztcafd_character in ${(s::)_ztcafd_time}; do
        case $_ztcafd_character in
            (0) _ztcafd_mask=(111 101 101 101 111) ;;
            (1) _ztcafd_mask=(001 001 001 001 001) ;;
            (2) _ztcafd_mask=(111 001 111 100 111) ;;
            (3) _ztcafd_mask=(111 001 111 001 111) ;;
            (4) _ztcafd_mask=(101 101 111 001 001) ;;
            (5) _ztcafd_mask=(111 100 111 001 111) ;;
            (6) _ztcafd_mask=(111 100 111 101 111) ;;
            (7) _ztcafd_mask=(111 001 001 001 001) ;;
            (8) _ztcafd_mask=(111 101 111 101 111) ;;
            (9) _ztcafd_mask=(111 101 111 001 111) ;;
            (:) _ztcafd_mask=( 0   1   0   1   0 ) ;;
        esac

        _ztcafd_staged+=(${(j:@n:)_ztcafd_mask})
    done


    # ───── set mask key ─────

    local -U _ztcafd_key=()

    _ztcafd_key+=('0#@r  ')
    _ztcafd_key+=('1#@i  ')
    _ztcafd_key+=('.#@r ')

    ztc:gizmo:stash face:digital:data:key _ztcafd_key


    # ───── interleave + flatten (with padding) ─────

    ztc:gizmo:weave _ztcafd_staged
    for _ztcafd_i in {1..${#_ztcafd_staged}}; do _ztcafd_staged[$_ztcafd_i]=${_ztcafd_staged[$_ztcafd_i]//@n/.}; done


    # ───── save ─────

    ztc:gizmo:stash face:digital:data _ztcafd_staged

}
